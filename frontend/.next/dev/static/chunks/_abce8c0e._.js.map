{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Quaantisc/Rentify/frontend/app/broker-login/page.tsx"],"sourcesContent":["\r\n\r\n// \"use client\";\r\n\r\n// import { useState, useEffect } from \"react\";\r\n// import { useAuthContext } from \"../context/AuthContext\";\r\n// import { useRouter } from \"next/navigation\";\r\n\r\n// export default function BrokerLogin() {\r\n//   const { login, isAuthenticated } = useAuthContext();\r\n//   const router = useRouter();\r\n\r\n//   const [phoneNumber, setPhoneNumber] = useState(\"\");\r\n//   const [otp, setOtp] = useState(\"\");\r\n//   const [step, setStep] = useState<\"phone\" | \"otp\">(\"phone\");\r\n//   const [timer, setTimer] = useState(0);\r\n//   const [canResend, setCanResend] = useState(true);\r\n//   const [message, setMessage] = useState(\"\");\r\n\r\n//   const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || \"http://localhost:7000\";\r\n\r\n//   // Redirect if already logged in\r\n//   useEffect(() => {\r\n//     if (isAuthenticated) {\r\n//       router.replace(\"/dashboard\"); // redirect to dashboard\r\n//     }\r\n//   }, [isAuthenticated, router]);\r\n\r\n//   // Countdown timer\r\n//   useEffect(() => {\r\n//     if (timer <= 0) return;\r\n//     const interval = setInterval(() => setTimer(t => t - 1), 1000);\r\n//     return () => clearInterval(interval);\r\n//   }, [timer]);\r\n\r\n//   useEffect(() => {\r\n//     setCanResend(timer <= 0);\r\n//   }, [timer]);\r\n\r\n//   // Send OTP\r\n//   const sendOtp = async () => {\r\n//     if (!phoneNumber) return;\r\n//     if (!/^\\+91\\d{10}$/.test(phoneNumber)) {\r\n//       setMessage(\"Phone number must be +91 followed by 10 digits\");\r\n//       return;\r\n//     }\r\n//     try {\r\n//       const res = await fetch(`${baseUrl}/api/brokers/login/request-otp`, {\r\n//         method: \"POST\",\r\n//         headers: { \"Content-Type\": \"application/json\" },\r\n//         body: JSON.stringify({ phoneNumber }),\r\n//       });\r\n//       const data = await res.json();\r\n//       if (res.ok) {\r\n//         setStep(\"otp\");\r\n//         setTimer(30);\r\n//         setMessage(\"OTP sent to your phone\");\r\n//       } else setMessage(data.message);\r\n//     } catch (err) {\r\n//       console.error(err);\r\n//       setMessage(\"Failed to send OTP\");\r\n//     }\r\n//   };\r\n\r\n//   // Verify OTP\r\n//   const verifyOtp = async () => {\r\n//     try {\r\n//       const res = await fetch(`${baseUrl}/api/brokers/login/verify`, {\r\n//         method: \"POST\",\r\n//         headers: { \"Content-Type\": \"application/json\" },\r\n//         body: JSON.stringify({ phoneNumber, otp }),\r\n//       });\r\n//       const data = await res.json();\r\n//       if (res.ok) {\r\n//         login(\"demo-token\", data.data); // login in context\r\n//         router.replace(\"/dashboard\"); // redirect to dashboard after login\r\n//       } else setMessage(data.message);\r\n//     } catch (err) {\r\n//       console.error(err);\r\n//       setMessage(\"Failed to verify OTP\");\r\n//     }\r\n//   };\r\n\r\n//   // Change phone number\r\n//   const changePhoneNumber = () => {\r\n//     setStep(\"phone\");\r\n//     setOtp(\"\");\r\n//     setMessage(\"\");\r\n//     setTimer(0);\r\n//   };\r\n\r\n//   return (\r\n//     <div className=\"p-8 max-w-md mx-auto text-black bg-white rounded\">\r\n//       {step === \"phone\" ? (\r\n//         <>\r\n//           <h2 className=\"text-2xl font-bold mb-4\">Broker Login</h2>\r\n//           <input\r\n//             placeholder=\"Phone +91...\"\r\n//             value={phoneNumber}\r\n//             onChange={e => setPhoneNumber(e.target.value)}\r\n//             className=\"border p-2 w-full mb-2\"\r\n//           />\r\n//           <button\r\n//             onClick={sendOtp}\r\n//             className=\"bg-blue-500 text-white p-2 w-full\"\r\n//           >\r\n//             Send OTP\r\n//           </button>\r\n//         </>\r\n//       ) : (\r\n//         <>\r\n//           <h2 className=\"text-2xl font-bold mb-4\">Enter OTP</h2>\r\n//           <input\r\n//             placeholder=\"OTP\"\r\n//             value={otp}\r\n//             onChange={e => setOtp(e.target.value)}\r\n//             className=\"border p-2 w-full mb-2\"\r\n//           />\r\n//           <button\r\n//             onClick={verifyOtp}\r\n//             className=\"bg-green-500 text-white p-2 w-full mb-2\"\r\n//           >\r\n//             Verify OTP & Login\r\n//           </button>\r\n\r\n//           <button\r\n//             onClick={changePhoneNumber}\r\n//             className=\"bg-gray-300 p-2 w-full mb-2\"\r\n//           >\r\n//             Change Phone Number\r\n//           </button>\r\n\r\n//           <button\r\n//             onClick={sendOtp}\r\n//             className={`p-2 w-full ${canResend ? \"bg-blue-500 text-white\" : \"bg-gray-300 text-gray-600 cursor-not-allowed\"}`}\r\n//             disabled={!canResend}\r\n//           >\r\n//             {canResend ? \"Resend OTP\" : `Resend OTP in ${timer}s`}\r\n//           </button>\r\n//         </>\r\n//       )}\r\n//       {message && <p className=\"mt-2 text-red-500\">{message}</p>}\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n\r\n\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useAuthContext } from \"../context/AuthContext\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\nexport default function BrokerLogin() {\r\n  const { login, isAuthenticated } = useAuthContext();\r\n  const router = useRouter();\r\n\r\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\r\n  const [otp, setOtp] = useState(\"\");\r\n  const [step, setStep] = useState<\"phone\" | \"otp\">(\"phone\");\r\n  const [timer, setTimer] = useState(0);\r\n  const [canResend, setCanResend] = useState(true);\r\n  const [message, setMessage] = useState(\"\");\r\n\r\n  const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || \"http://localhost:7000\";\r\n\r\n  // Redirect if already logged in\r\n  useEffect(() => {\r\n    if (isAuthenticated) router.push(\"/dashboard\");\r\n  }, [isAuthenticated, router]);\r\n\r\n  // Countdown timer\r\n  useEffect(() => {\r\n    if (timer <= 0) return;\r\n    const interval = setInterval(() => setTimer(t => t - 1), 1000);\r\n    return () => clearInterval(interval);\r\n  }, [timer]);\r\n\r\n  useEffect(() => {\r\n    setCanResend(timer <= 0);\r\n  }, [timer]);\r\n\r\n  // Send OTP\r\n  const sendOtp = async () => {\r\n    if (!phoneNumber) return;\r\n    try {\r\n      const res = await fetch(`${baseUrl}/api/brokers/login/request-otp`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ phoneNumber }),\r\n      });\r\n      const data = await res.json();\r\n      if (res.ok) {\r\n        setStep(\"otp\");\r\n        setTimer(30);\r\n        setMessage(\"OTP sent to your phone\");\r\n      } else setMessage(data.message);\r\n    } catch (err) {\r\n      console.error(err);\r\n      setMessage(\"Failed to send OTP\");\r\n    }\r\n  };\r\n\r\n  // Verify OTP\r\n  const verifyOtp = async () => {\r\n    try {\r\n      const res = await fetch(`${baseUrl}/api/brokers/login/verify`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ phoneNumber, otp }),\r\n      });\r\n      const data = await res.json();\r\nif (res.ok) {\r\n  login(data.token, data.broker); // Save token and broker to context/localStorage\r\n  router.push(\"/dashboard\");     // Redirect to dashboard immediately\r\n} setMessage(data.message);\r\n    } catch (err) {\r\n      console.error(err);\r\n      setMessage(\"Failed to verify OTP\");\r\n    }\r\n  };\r\n\r\n  const changePhoneNumber = () => {\r\n    setStep(\"phone\");\r\n    setOtp(\"\");\r\n    setMessage(\"\");\r\n    setTimer(0);\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-8 max-w-md mx-auto text-black bg-white rounded\">\r\n      {step === \"phone\" ? (\r\n        <>\r\n          <h2 className=\"text-2xl font-bold mb-4\">Broker Login</h2>\r\n          <input\r\n            placeholder=\"Phone +91...\"\r\n            value={phoneNumber}\r\n            onChange={e => setPhoneNumber(e.target.value)}\r\n            className=\"border p-2 w-full mb-2\"\r\n          />\r\n          <button onClick={sendOtp} className=\"bg-blue-500 text-white p-2 w-full\">\r\n            Send OTP\r\n          </button>\r\n        </>\r\n      ) : (\r\n        <>\r\n          <h2 className=\"text-2xl font-bold mb-4\">Enter OTP</h2>\r\n          <input\r\n            placeholder=\"OTP\"\r\n            value={otp}\r\n            onChange={e => setOtp(e.target.value)}\r\n            className=\"border p-2 w-full mb-2\"\r\n          />\r\n          <button\r\n            onClick={verifyOtp}\r\n            className=\"bg-green-500 text-white p-2 w-full mb-2\"\r\n          >\r\n            Verify OTP & Login\r\n          </button>\r\n\r\n          <button onClick={changePhoneNumber} className=\"bg-gray-300 p-2 w-full mb-2\">\r\n            Change Phone Number\r\n          </button>\r\n\r\n          <button\r\n            onClick={sendOtp}\r\n            className={`p-2 w-full ${\r\n              canResend ? \"bg-blue-500 text-white\" : \"bg-gray-300 text-gray-600 cursor-not-allowed\"\r\n            }`}\r\n            disabled={!canResend}\r\n          >\r\n            {canResend ? \"Resend OTP\" : `Resend OTP in ${timer}s`}\r\n          </button>\r\n        </>\r\n      )}\r\n      {message && <p className=\"mt-2 text-red-500\">{message}</p>}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 359, "column": 0}, "map": {"version":3,"sources":["file:///D:/Quaantisc/Rentify/frontend/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0]}}]
}