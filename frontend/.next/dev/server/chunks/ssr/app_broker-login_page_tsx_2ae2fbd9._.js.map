{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Quaantisc/Rentify/frontend/app/broker-login/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useAuthContext } from \"../context/AuthContext\";\r\n\r\nexport default function BrokerLogin() {\r\n  const { login } = useAuthContext();\r\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\r\n  const [otp, setOtp] = useState(\"\");\r\n  const [step, setStep] = useState<\"phone\" | \"otp\">(\"phone\");\r\n  const [timer, setTimer] = useState(0);\r\n  const [canResend, setCanResend] = useState(true);\r\n  const [message, setMessage] = useState(\"\");\r\n\r\n  const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || \"http://localhost:7000\";\r\n\r\n  // Countdown timer\r\n  useEffect(() => {\r\n    if (timer <= 0) return;\r\n    const interval = setInterval(() => setTimer(t => t - 1), 1000);\r\n    return () => clearInterval(interval);\r\n  }, [timer]);\r\n\r\n  useEffect(() => {\r\n    setCanResend(timer <= 0);\r\n  }, [timer]);\r\n\r\n  // Send OTP\r\n  const sendOtp = async () => {\r\n    if (!phoneNumber) return;\r\n    try {\r\n      const res = await fetch(`${baseUrl}/api/brokers/login/request-otp`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ phoneNumber }),\r\n      });\r\n      const data = await res.json();\r\n      if (res.ok) {\r\n        setStep(\"otp\");\r\n        setTimer(30); // start 30 sec countdown\r\n        setMessage(\"OTP sent to your phone\");\r\n      } else setMessage(data.message);\r\n    } catch (err) {\r\n      console.error(err);\r\n      setMessage(\"Failed to send OTP\");\r\n    }\r\n  };\r\n\r\n  // Verify OTP\r\n  const verifyOtp = async () => {\r\n    try {\r\n      const res = await fetch(`${baseUrl}/api/brokers/login/verify`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ phoneNumber, otp }),\r\n      });\r\n      const data = await res.json();\r\n      if (res.ok) {\r\n        // Login in context\r\n        login(\"demo-token\", data.data); // replace \"demo-token\" with actual token from API\r\n      } else setMessage(data.message);\r\n    } catch (err) {\r\n      console.error(err);\r\n      setMessage(\"Failed to verify OTP\");\r\n    }\r\n  };\r\n\r\n  // Change phone number\r\n  const changePhoneNumber = () => {\r\n    setStep(\"phone\");\r\n    setOtp(\"\");\r\n    setMessage(\"\");\r\n    setTimer(0);\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-8 max-w-md mx-auto text-black bg-white rounded\">\r\n      {step === \"phone\" ? (\r\n        <>\r\n          <h2 className=\"text-2xl font-bold mb-4\">Broker Login</h2>\r\n          <input\r\n            placeholder=\"Phone +91...\"\r\n            value={phoneNumber}\r\n            onChange={e => setPhoneNumber(e.target.value)}\r\n            className=\"border p-2 w-full mb-2\"\r\n          />\r\n          <button\r\n            onClick={sendOtp}\r\n            className=\"bg-blue-500 text-white p-2 w-full\"\r\n          >\r\n            Send OTP\r\n          </button>\r\n        </>\r\n      ) : (\r\n        <>\r\n          <h2 className=\"text-2xl font-bold mb-4\">Enter OTP</h2>\r\n          <input\r\n            placeholder=\"OTP\"\r\n            value={otp}\r\n            onChange={e => setOtp(e.target.value)}\r\n            className=\"border p-2 w-full mb-2\"\r\n          />\r\n          <button\r\n            onClick={verifyOtp}\r\n            className=\"bg-green-500 text-white p-2 w-full mb-2\"\r\n          >\r\n            Verify OTP & Login\r\n          </button>\r\n\r\n          <button\r\n            onClick={changePhoneNumber}\r\n            className=\"bg-gray-300 p-2 w-full mb-2\"\r\n          >\r\n            Change Phone Number\r\n          </button>\r\n\r\n          <button\r\n            onClick={sendOtp}\r\n            className={`p-2 w-full ${canResend ? \"bg-blue-500 text-white\" : \"bg-gray-300 text-gray-600 cursor-not-allowed\"}`}\r\n            disabled={!canResend}\r\n          >\r\n            {canResend ? \"Resend OTP\" : `Resend OTP in ${timer}s`}\r\n          </button>\r\n        </>\r\n      )}\r\n      {message && <p className=\"mt-2 text-red-500\">{message}</p>}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}